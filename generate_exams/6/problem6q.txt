create database problem6;
use problem6;

create table article (
   id int unsigned not null primary key auto_increment,
	 published_on date,
	 name varchar(20)
);

create table category (
   id int unsigned not null primary key auto_increment,
	 name varchar(20),
	 date_created_on date
);

create table user (
   id int unsigned not null primary key auto_increment,
	 age int,
	 name varchar(20),
	 password varchar(20)
);

create table tag (
   id int unsigned not null primary key auto_increment,
	 name varchar(20),
	 description varchar(20)
);

create table tag_category (
   id int unsigned not null primary key auto_increment,
   category_id int unsigned not null,
   tag_id int unsigned not null
);

alter table article add column user_id int unsigned not null;
create table user_tag (
   id int unsigned not null primary key auto_increment,
   tag_id int unsigned not null,
   user_id int unsigned not null
);

insert into article (id,published_on,name, user_id) values
	(1, '2013-06-05', 'esfsef', 1),
  (2, '2014-06-05', 'sefesfe', 2);

insert into category (id,name,date_created_on) values
	(1, 'esfsese', '2013-05-04'),
  (2, 'sefsefse', '2014-02-22');

insert into user (id,age,name,password) values
	(1, 21, 'efsefse', '123'),
  (2, 54, 'efsef', '0000');

insert into tag (id,name,description) values
	(1, 'kjheuj', 'seoisefoseoi'),
  (2, 'liuefuise', 'eiufuief');

insert into tag_category(id, tag_id, category_id) values
  (1, 2, 2),
  (2, 1, 1);

insert into user_tag(id, user_id, tag_id) values
  (1, 2, 1), 
  (2, 1, 2);

select user.* from user_tag join user on user.id = user_tag.user_id join tag_category on user_tag.tag_id = tag_category.tag_id where tag_category.category_id = (select category.id from category where category.name = 'esfsese');

create table tag_part1 (id int unsigned not null auto_increment, description varchar(20), primary key (id));
create table tag_part2 (id int unsigned not null auto_increment, name varchar(20), primary key (id));
insert into tag_part1 (description) select description from tag;
insert into tag_part2 (name) select name from tag;
drop table tag;

select article.* from user_tag join tag_part2 on user_tag.tag_id = tag_part2.id join article on article.user_id=user_tag.user_id where tag_part2.name='kjheuj';

